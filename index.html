<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Ciao!</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        /* --- RESET & MOBILE OPTIMIZATION --- */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: #fff9f5;
            color: #4a4a4a;
            /* Fix per mobile address bar */
            min-height: 100vh; 
            height: 100dvh; 
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        /* --- DECORAZIONI FLUTTUANTI (SFONDO) --- */
        .background-deco {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
            pointer-events: none;
        }

        .floating-icon {
            position: absolute;
            font-size: 1.5rem;
            opacity: 0.15;
            animation: floatIcon 10s infinite ease-in-out alternate;
        }

        /* Posizionamento icone sfondo */
        .icon-1 { top: 10%; left: 10%; animation-delay: 0s; font-size: 2rem; } /* Albero */
        .icon-2 { top: 20%; right: 15%; animation-delay: -2s; font-size: 1.5rem; } /* Fiocco neve */
        .icon-3 { bottom: 15%; left: 15%; animation-delay: -5s; font-size: 1.8rem; } /* Regalo */
        .icon-4 { bottom: 25%; right: 10%; animation-delay: -7s; font-size: 1.2rem; } /* Stella */

        @keyframes floatIcon {
            0% { transform: translateY(0) rotate(-10deg); }
            100% { transform: translateY(-20px) rotate(10deg); }
        }

        /* Blobs di colore */
        .blob {
            position: absolute;
            border-radius: 50%;
            filter: blur(60px);
            opacity: 0.4;
            z-index: -2;
        }
        .blob-1 { width: 300px; height: 300px; background: #ffe5d9; top: -50px; left: -50px; }
        .blob-2 { width: 250px; height: 250px; background: #e3f2fd; bottom: -50px; right: -50px; }

        /* --- CONTAINER CENTRALE --- */
        #app {
            width: 100%;
            max-width: 380px;
            padding: 24px;
            text-align: center;
            position: relative;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* --- HERO GIFT (ANIMAZIONE PRINCIPALE) --- */
        .hero-gift-container {
            margin-bottom: 20px;
        }
        
        .hero-gift {
            font-size: 4rem;
            display: inline-block;
            animation: giftBounce 2.5s infinite ease-in-out;
            filter: drop-shadow(0 10px 15px rgba(0,0,0,0.1));
        }

        @keyframes giftBounce {
            0%, 100% { transform: translateY(0) rotate(-3deg); }
            50% { transform: translateY(-15px) rotate(3deg) scale(1.05); }
        }

        /* --- SLIDE SYSTEM --- */
        .slide {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            padding: 0 24px;
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .slide.active {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
            transform: translate(-50%, -50%);
        }

        .slide.exit-up {
            opacity: 0;
            transform: translate(-50%, -100%) scale(0.9);
        }

        /* Animazione a cascata degli elementi */
        .slide .anim-el {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s cubic-bezier(0.2, 0.8, 0.2, 1), transform 0.6s cubic-bezier(0.2, 0.8, 0.2, 1);
        }

        .slide.active .anim-el {
            opacity: 1;
            transform: translateY(0);
        }

        /* Ritardi sequenziali */
        .slide.active .anim-el:nth-child(1) { transition-delay: 0.1s; }
        .slide.active .anim-el:nth-child(2) { transition-delay: 0.2s; }
        .slide.active .anim-el:nth-child(3) { transition-delay: 0.3s; }
        .slide.active .anim-el:nth-child(4) { transition-delay: 0.4s; }
        .slide.active .anim-el:nth-child(5) { transition-delay: 0.5s; }

        /* --- TYPOGRAPHY --- */
        h1 {
            font-size: 1.6rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #333;
            line-height: 1.3;
        }

        p {
            font-size: 1.05rem;
            margin-bottom: 1.5rem;
            color: #555;
            font-weight: 300;
            line-height: 1.6;
        }

        .big-text {
            font-size: 1.3rem;
            font-weight: 500;
            color: #333;
            margin-bottom: 2rem;
            line-height: 1.5;
        }

        .highlight {
            color: #d4a373;
            font-weight: 600;
        }

        /* --- BUTTONS --- */
        .btn-container {
            display: flex;
            flex-direction: column;
            gap: 14px;
            width: 100%;
            margin-top: 10px;
        }

        button {
            background: #fff;
            border: none;
            color: #555;
            padding: 20px;
            border-radius: 22px;
            font-size: 1rem;
            font-family: inherit;
            font-weight: 500;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.06);
            transition: transform 0.15s, background 0.2s;
            width: 100%;
            outline: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            position: relative;
            touch-action: manipulation;
        }

        button:active {
            transform: scale(0.96);
            background-color: #f0f0f0;
        }

        button.primary {
            background-color: #333;
            color: #fff;
            box-shadow: 0 8px 25px rgba(51, 51, 51, 0.25);
        }

        button.primary:active {
            background-color: #000;
        }

        button.secondary {
            background: transparent;
            color: #999;
            box-shadow: none;
            font-size: 0.9rem;
            padding: 12px;
        }

        /* Scelte finali */
        button.choice {
            text-align: left;
            justify-content: flex-start;
            border: 1px solid rgba(0,0,0,0.03);
            font-size: 1.1rem;
        }

        button.special {
            background: linear-gradient(135deg, #fff 0%, #fffbf7 100%);
            border: 1px solid #ffe5d9;
            color: #d4a373;
            font-weight: 600;
        }

        .emoji-icon {
            font-size: 1.5rem;
            min-width: 30px;
        }

        /* --- CORIANDOLI --- */
        .confetti {
            position: absolute;
            width: 8px;
            height: 8px;
            background-color: #f00;
            animation: fall linear forwards;
            top: -10px;
            z-index: 999;
            border-radius: 50%;
        }

        @keyframes fall {
            to { transform: translateY(110vh) rotate(720deg); }
        }

    </style>
</head>
<body>

    <!-- Sfondo decorativo animato -->
    <div class="background-deco">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        
        <!-- Icone natalizie fluttuanti -->
        <div class="floating-icon icon-1">üéÑ</div>
        <div class="floating-icon icon-2">‚ùÑÔ∏è</div>
        <div class="floating-icon icon-3">üéÅ</div>
        <div class="floating-icon icon-4">‚ú®</div>
    </div>

    <div id="app">

        <!-- SCHERMATA 1 -->
        <div id="step-1" class="slide active">
            
            <!-- Pacco Animato -->
            <div class="hero-gift-container anim-el">
                <span class="hero-gift">üéÅ</span>
            </div>

            <h1 class="anim-el">Ciao, come stai? üëã</h1>
            <p class="anim-el">Buon Natale in ritardo.<br>
            Spero che tu non abbia vinto un astuccio dell'<span class="highlight">Eastpak</span> alla tombola natalizia.</p>
            <p class="anim-el">Ci tenevo a chiederti una cosa...</p>
            
            <div class="btn-container anim-el">
                <button class="primary" onclick="nextStep(2)">Sono curiosa</button>
                <button class="secondary" onclick="endGame('blocked')">Non voglio saperlo</button>
            </div>
        </div>

        <!-- SCHERMATA 2 -->
        <div id="step-2" class="slide">
            <div class="big-text anim-el">
                Mi hai detto che non potevamo sentirci per messaggio...
            </div>
            <p class="anim-el">...ma non che <i>non avrei potuto chiederti di uscire in qualche altro modo</i>.</p>
            <p class="anim-el" style="font-weight: 500;">Quindi...</p>
            
            <div class="btn-container anim-el">
                <button class="primary" onclick="nextStep(3)">Avanti</button>
            </div>
        </div>

        <!-- SCHERMATA 3 -->
        <div id="step-3" class="slide">
            <div class="big-text anim-el">
                So che in teoria dovevano essere <span class="highlight">14 giorni di detox</span>.
            </div>
            <p class="anim-el">Ma vorrei uscire con te</p>
            <p class="anim-el">Ti va se...</p>
            
            <div class="btn-container anim-el">
                <button class="primary" onclick="nextStep(4)">Avanti</button>
            </div>
        </div>

        <!-- SCHERMATA 4 - SCELTE -->
        <div id="step-4" class="slide">
            
            <div style="height: 10px;"></div>
            
            <div class="btn-container anim-el">
                <button class="choice" onclick="endGame('Sigaretta')">
                    <span class="emoji-icon">üö¨</span> Sigaretta insieme
                </button>
                
                <button class="choice" onclick="endGame('Aperitivo')">
                    <span class="emoji-icon">üçπ</span> Aperitivo insieme
                </button>
                
                <button class="choice" onclick="endGame('Cena')">
                    <span class="emoji-icon">ü§®</span> Cena
                </button>

                <div style="height: 15px;"></div>

                <button class="choice special" onclick="endGame('BabboNatale')">
                    <span class="emoji-icon">‚úàÔ∏è</span> Andiamo a vedere babbo natale
                </button>
            </div>
        </div>

        <!-- SCHERMATA FINALE -->
        <div id="step-final" class="slide">
            <div class="hero-gift-container anim-el">
                <span class="hero-gift" style="animation-duration: 1.5s;">ü•Ç</span>
            </div>
            <h1 class="anim-el" style="font-size: 2.2rem;">Affare fatto ‚ú®</h1>
        </div>

        <!-- SCHERMATA BLOCCO -->
        <div id="step-blocked" class="slide">
            <h1 class="anim-el">Nessun problema üòå</h1>
            <p class="anim-el">Il gioco finisce qui.<br>Buon detox!</p>
        </div>

    </div>

    <script>
        function nextStep(stepNumber) {
            const currentSlide = document.querySelector('.slide.active');
            
            currentSlide.classList.remove('active');
            currentSlide.classList.add('exit-up');

            setTimeout(() => {
                currentSlide.style.visibility = 'hidden'; 
                currentSlide.classList.remove('exit-up'); 
                
                const nextSlide = document.getElementById('step-' + stepNumber);
                nextSlide.style.visibility = 'visible'; 
                void nextSlide.offsetWidth; // Force Reflow
                nextSlide.classList.add('active');
            }, 300);
        }

        function endGame(choice) {
            const currentSlide = document.querySelector('.slide.active');
            currentSlide.classList.remove('active');
            currentSlide.classList.add('exit-up');

            setTimeout(() => {
                let finalScreenId = 'step-final';
                if(choice === 'blocked') {
                    finalScreenId = 'step-blocked';
                } else {
                    launchConfetti();
                }
                
                const finalSlide = document.getElementById(finalScreenId);
                finalSlide.classList.add('active');
            }, 300);
        }

        // Sistema di coriandoli
        function launchConfetti() {
            const colors = ['#ffadad', '#ffd6a5', '#fdffb6', '#caffbf', '#9bf6ff', '#a0c4ff', '#bdb2ff', '#ffc6ff'];
            const confettiCount = 60; 

            for (let i = 0; i < confettiCount; i++) {
                const confetti = document.createElement('div');
                confetti.classList.add('confetti');
                const bg = colors[Math.floor(Math.random() * colors.length)];
                const left = Math.random() * 100 + 'vw';
                const animDuration = Math.random() * 3 + 2 + 's'; 
                const size = Math.random() * 6 + 5 + 'px';

                confetti.style.backgroundColor = bg;
                confetti.style.left = left;
                confetti.style.width = size;
                confetti.style.height = size;
                confetti.style.animationDuration = animDuration;
                
                document.body.appendChild(confetti);

                setTimeout(() => { confetti.remove(); }, 5000);
            }
        }
    </script>
</body>
</html>
