<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Ciao!</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        /* --- RESET & MOBILE OPTIMIZATION --- */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: #fff9f5;
            color: #4a4a4a;
            min-height: 100vh; 
            height: 100dvh; 
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        /* --- DECORAZIONI SFONDO --- */
        .background-deco {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
            pointer-events: none;
        }

        .blob {
            position: absolute;
            border-radius: 50%;
            filter: blur(60px);
            opacity: 0.4;
            z-index: -2;
        }
        .blob-1 { width: 300px; height: 300px; background: #ffe5d9; top: -50px; left: -50px; }
        .blob-2 { width: 250px; height: 250px; background: #e3f2fd; bottom: -50px; right: -50px; }

        .floating-icon {
            position: absolute;
            font-size: 1.5rem;
            opacity: 0.15;
            animation: floatIcon 10s infinite ease-in-out alternate;
        }
        .icon-1 { top: 10%; left: 10%; animation-delay: 0s; } 
        .icon-2 { top: 20%; right: 15%; animation-delay: -2s; } 
        .icon-3 { bottom: 15%; left: 15%; animation-delay: -5s; } 

        @keyframes floatIcon {
            0% { transform: translateY(0) rotate(-10deg); }
            100% { transform: translateY(-20px) rotate(10deg); }
        }

        /* --- CONTAINER --- */
        #app {
            width: 100%;
            max-width: 380px;
            padding: 24px;
            text-align: center;
            position: relative;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* --- SLIDE SYSTEM --- */
        .slide {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            padding: 0 24px;
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .slide.active {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
            transform: translate(-50%, -50%);
        }

        .slide.exit-up {
            opacity: 0;
            transform: translate(-50%, -100%) scale(0.9);
        }

        /* Animazioni interne */
        .slide .anim-el {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s cubic-bezier(0.2, 0.8, 0.2, 1), transform 0.6s cubic-bezier(0.2, 0.8, 0.2, 1);
        }

        .slide.active .anim-el {
            opacity: 1;
            transform: translateY(0);
        }

        /* Delays */
        .slide.active .anim-el:nth-child(1) { transition-delay: 0.1s; }
        .slide.active .anim-el:nth-child(2) { transition-delay: 0.2s; }
        .slide.active .anim-el:nth-child(3) { transition-delay: 0.3s; }
        .slide.active .anim-el:nth-child(4) { transition-delay: 0.4s; }

        /* --- TYPOGRAPHY --- */
        h1 {
            font-size: 1.6rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #333;
            line-height: 1.3;
        }

        p {
            font-size: 1.05rem;
            margin-bottom: 1.5rem;
            color: #555;
            font-weight: 300;
            line-height: 1.6;
        }

        .big-text {
            font-size: 1.3rem;
            font-weight: 500;
            color: #333;
            margin-bottom: 2rem;
            line-height: 1.5;
        }

        .highlight { color: #d4a373; font-weight: 600; }

        .tiny-text {
            font-size: 0.75rem !important;
            color: #999 !important;
            line-height: 1.4 !important;
            margin-bottom: 30px !important;
        }

        .small-note {
            font-size: 0.85em;
            color: #888;
            font-weight: 400;
            display: inline-block;
        }

        .or-text {
            margin: 10px 0;
            font-weight: 500;
            color: #d4a373;
        }

        /* STILE IMMAGINE CAPPUCCINO */
        .latte-img {
            width: 200px;
            height: auto;
            display: block;
            margin: 0 auto 20px auto;
            border-radius: 15px; 
            filter: drop-shadow(0 10px 15px rgba(139, 69, 19, 0.15));
            animation: floatIcon 6s infinite ease-in-out;
        }

        /* --- BUTTONS --- */
        .btn-container {
            display: flex;
            flex-direction: column;
            gap: 14px;
            width: 100%;
            margin-top: 10px;
        }

        button {
            background: #fff;
            border: none;
            color: #555;
            padding: 18px 20px;
            border-radius: 20px;
            font-size: 1rem;
            font-family: inherit;
            font-weight: 500;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.06);
            transition: transform 0.15s, background 0.2s, box-shadow 0.2s;
            width: 100%;
            outline: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            touch-action: manipulation;
        }

        button:active { transform: scale(0.97); }

        button.primary {
            background-color: #333;
            color: #fff;
            box-shadow: 0 8px 25px rgba(51, 51, 51, 0.25);
        }

        button.primary:active { background-color: #000; }

        button.secondary {
            background: transparent;
            color: #999;
            box-shadow: none;
            font-size: 0.9rem;
            padding: 12px;
        }

        /* Stile opzioni statiche (non cliccabili) */
        .static-option {
            background: #fff;
            padding: 18px 20px;
            border-radius: 20px;
            font-size: 1rem;
            color: #555;
            box-shadow: 0 2px 10px rgba(0,0,0,0.03);
            text-align: left;
            border: 1px solid rgba(0,0,0,0.05);
            display: flex;
            align-items: center;
            gap: 10px;
            opacity: 0.8;
        }

        /* --- IL GIOCO DEI PACCHI --- */
        .gifts-grid {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
            width: 100%;
        }

        .gift-box {
            width: 90px;
            height: 90px;
            background: #ffadad;
            border-radius: 12px;
            position: relative;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(255, 173, 173, 0.4);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            transition: transform 0.2s;
        }

        .gift-box:active { transform: scale(0.9); }
        
        .gift-box.opened {
            background: #fff;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.05);
            pointer-events: none;
        }

        .gift-content { font-size: 1.8rem; display: none; }
        .winning-ticket { font-size: 0.8rem; line-height: 1.2; color: #d4a373; font-weight: 600; }

        /* --- SCENA BABBO NATALE (CON SFONDO LAPPONIA) --- */
        .santa-scene-wrapper {
            width: 100%;
            height: 180px; /* Un po' pi√π alto per vedere la foto */
            position: relative;
            overflow: hidden; 
            margin-bottom: 10px;
            border-radius: 15px;
            /* Qui carichiamo l'immagine di sfondo */
            background: url('lapponia.jpg') center center no-repeat;
            background-size: cover;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        /* Overlay leggero per far risaltare la slitta scura */
        .santa-scene-wrapper::after {
            content: '';
            position: absolute;
            top: 0; 
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.2); /* Leggera patina chiara */
            pointer-events: none;
        }

        .sleigh-container {
            position: absolute;
            top: 40px; /* Regola l'altezza del volo */
            right: -180px; 
            z-index: 2;
            display: flex;
            align-items: flex-end;
            /* Ombra Cinese molto scura per contrastare con la foto */
            filter: brightness(0) opacity(0.9); 
            transform: scale(0.7); 
        }

        .silhouette-part {
            font-size: 3rem; 
            line-height: 1;
            margin-left: -15px; 
        }
        
        .reindeer { transform: rotate(-10deg); font-size: 3.2rem; }
        .sleigh { transform: rotate(-5deg); margin-bottom: -5px; }

        .fly-active {
            animation: flyAcross 3s linear forwards;
        }

        @keyframes flyAcross {
            0% { right: -180px; transform: scale(0.7) translateY(0); }
            25% { transform: scale(0.7) translateY(-20px) rotate(-2deg); }
            50% { transform: scale(0.7) translateY(0) rotate(0deg); }
            75% { transform: scale(0.7) translateY(15px) rotate(2deg); }
            100% { right: 120%; transform: scale(0.7) translateY(-10px); } 
        }

        .joke-text {
            opacity: 0;
            font-size: 0.9rem;
            color: #888;
            font-style: italic;
            margin-top: 5px;
            margin-bottom: 20px;
            transition: opacity 1s ease;
        }
        
        .joke-visible { opacity: 1; }

        /* --- CORIANDOLI --- */
        .confetti {
            position: absolute;
            width: 8px;
            height: 8px;
            background-color: #f00;
            animation: fall linear forwards;
            top: -10px;
            z-index: 999;
            border-radius: 50%;
        }

        @keyframes fall { to { transform: translateY(110vh) rotate(720deg); } }

    </style>
</head>
<body>

    <div class="background-deco">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="floating-icon icon-1">‚ùÑÔ∏è</div>
        <div class="floating-icon icon-2">üéÑ</div>
        <div class="floating-icon icon-3">‚ú®</div>
    </div>

    <div id="app">

        <!-- SLIDE 1: INTRO -->
        <div id="step-1" class="slide active">
            <h1 class="anim-el">Ciao, come stai? üëã</h1>
            <p class="anim-el">Buon Natale in ritardo.<br>
            Spero che tu non abbia vinto un astuccio dell'<span class="highlight">Eastpak</span> alla tombola natalizia...</p>
            <p class="anim-el">Ci tenevo a chiederti una cosa...</p>
            
            <div class="btn-container anim-el">
                <button class="primary" onclick="nextStep(2)">Sono curiosa</button>
                <button class="secondary" onclick="endGame('blocked')">Non voglio saperlo</button>
            </div>
        </div>

        <!-- SLIDE 2: TECNICO -->
        <div id="step-2" class="slide">
            <div class="big-text anim-el">
                Mi hai detto che non potevamo sentirci per messaggio...
            </div>
            <p class="anim-el">...ma non che <i>non avrei potuto chiederti di uscire in qualche altro modo</i>.</p>
            <p class="anim-el" style="font-weight: 500;">Quindi...</p>
            
            <div class="btn-container anim-el">
                <button class="primary" onclick="nextStep(3)">Avanti</button>
            </div>
        </div>

        <!-- SLIDE 3: DETOX -->
        <div id="step-3" class="slide">
            <div class="big-text anim-el">
                So che in teoria dovevano essere <span class="highlight">14 giorni di detox</span>.
            </div>
            <p class="anim-el">Ma vorrei uscire con te per sapere come va la tua vita</p>
            
            <p class="anim-el" style="margin-top: 20px; font-weight: 600;">Quindi...</p>
            <div class="btn-container anim-el">
                <button class="primary" onclick="nextStep(4)">Avanti</button>
            </div>
        </div>

        <!-- SLIDE 4: INTRO GIOCO -->
        <div id="step-4" class="slide">
            <h1 class="anim-el" style="font-size: 2rem;">Facciamo un gioco üé≤</h1>
            <div class="btn-container anim-el" style="margin-top: 30px;">
                <button class="primary" onclick="nextStep(5)">Avanti</button>
            </div>
        </div>

        <!-- SLIDE 5: PACCHI -->
        <div id="step-5" class="slide">
            <h1 class="anim-el">Apri i pacchi e prova a vincere</h1>
            <p class="anim-el">Vediamo quanto sei fortunata...</p>
            
            <div class="gifts-grid anim-el">
                <div class="gift-box" onclick="openGift(this)">
                    <span class="gift-lid">üéÅ</span>
                    <span class="gift-content">üò¢</span>
                </div>
                <div class="gift-box" onclick="openGift(this)">
                    <span class="gift-lid">üéÅ</span>
                    <span class="gift-content">üò¢</span>
                </div>
                <div class="gift-box" onclick="openGift(this)">
                    <span class="gift-lid">üéÅ</span>
                    <span class="gift-content winning-content">üéüÔ∏è</span>
                </div>
            </div>

            <div id="win-message" style="display: none; margin-top: 10px;">
                <p class="highlight" style="font-size: 1.1rem;">Hai vinto un aperitivo, complimenti! ü•Ç</p>
                <div class="btn-container">
                    <button class="primary" onclick="nextStep(6)">Avanti</button>
                </div>
            </div>
        </div>

        <!-- SLIDE 6: ALTERNATIVE (MODIFICATA) -->
        <div id="step-6" class="slide">
            <p class="anim-el">Se l'aperitivo non dovesse essere di tuo gradimento puoi selezionare un'opzione tra:</p>
            
            <div class="btn-container anim-el">
                <!-- Opzioni non cliccabili (Statiche) -->
                <div class="static-option">
                    <span>üö¨ Sigaretta <span class="small-note">(non in piazzetta)</span></span>
                </div>
                
                <div class="static-option">
                    <span>ü§® Cena insieme</span>
                </div>

                 <div class="static-option">
                    <span>üé¨ Cinema</span>
                </div>
                
                <!-- Oppure come testo centrale -->
                <div class="or-text">ü§î Oppure...</div>
                
                <!-- Pulsante Avanti -->
                <button class="primary" onclick="nextStep(7)">Avanti</button>
            </div>
        </div>

        <!-- SLIDE 7: BABBO NATALE (CON FOTO LAPPONIA) -->
        <div id="step-7" class="slide">
            <h1 class="anim-el">Potremmo visitare insieme la casa di Babbo Natale</h1>
            
            <div class="santa-scene-wrapper anim-el">
                <!-- Lo sfondo √® gestito nel CSS con lapponia.jpg -->
                
                <!-- Slitta Animata (Ombra) -->
                <div id="santa-group" class="sleigh-container">
                    <span class="silhouette-part reindeer">ü¶å</span>
                    <span class="silhouette-part reindeer" style="margin-left: -25px; transform: translateY(5px) rotate(-10deg);">ü¶å</span>
                    <span class="silhouette-part sleigh">üõ∑</span>
                    <span class="silhouette-part" style="margin-left: -45px; margin-bottom: 10px; font-size: 2.5rem;">üéÖ</span>
                </div>
            </div>

            <p id="joke-text" class="joke-text">(Sto scherzando)</p>

            <!-- PULSANTE INIZIALMENTE NASCOSTO -->
            <div id="santa-btn-container" class="btn-container" style="opacity: 0; visibility: hidden; transition: opacity 1s;">
                <button class="primary" onclick="nextStep(8)">Avanti</button>
            </div>
        </div>

        <!-- SLIDE 8: FINALE CRINGE CON FOTO -->
        <div id="step-8" class="slide">
            
            <!-- CONTENITORE FOTO -->
            <div class="anim-el">
                <!-- Mantenuto il nome che funzionava a te -->
                <img src="foto.jpg.png" class="latte-img" alt="Ritratto Cappuccino">
            </div>

            <p class="anim-el tiny-text">
                (Non volevo essere cos√¨ cringe ma vorrei uscire con te e Miriana non √® d'accordo quindi ho dovuto inventare qualcosa)
            </p>
            
            <div class="btn-container anim-el">
                <button class="primary" onclick="endGame('final')">Fine</button>
            </div>
        </div>

        <!-- SLIDE BLOCCO -->
        <div id="step-blocked" class="slide">
            <h1>Peccato ü•≤</h1>
            <p>Grazie lo stesso per aver giocato!</p>
        </div>

         <!-- SLIDE FINE -->
         <div id="step-end-screen" class="slide">
            <h1>A presto! ‚ú®</h1>
        </div>

    </div>

    <script>
        // Gestione Passaggi Slide
        function nextStep(stepNumber) {
            const currentSlide = document.querySelector('.slide.active');
            currentSlide.classList.remove('active');
            currentSlide.classList.add('exit-up');

            setTimeout(() => {
                currentSlide.style.visibility = 'hidden'; 
                currentSlide.classList.remove('exit-up'); 
                
                const nextSlide = document.getElementById('step-' + stepNumber);
                nextSlide.style.visibility = 'visible'; 
                void nextSlide.offsetWidth; // Force Reflow
                nextSlide.classList.add('active');

                // SEZIONE SPECIALE PER SLIDE BABBO NATALE (STEP 7)
                if(stepNumber === 7) {
                    triggerSantaAnimation();
                }

            }, 300);
        }

        // Animazione Babbo Natale + Testo Scherzo
        function triggerSantaAnimation() {
            const sleigh = document.getElementById('santa-group');
            const jokeText = document.getElementById('joke-text');
            const btnContainer = document.getElementById('santa-btn-container');
            
            // Avvia animazione slitta
            sleigh.classList.add('fly-active');

            // Aspetta 4.5 secondi (quando la slitta √® uscita) e mostra il testo
            setTimeout(() => {
                jokeText.classList.add('joke-visible');
                
                // Aspetta ancora un po' per far leggere, poi mostra il pulsante
                setTimeout(() => {
                    btnContainer.style.visibility = 'visible';
                    btnContainer.style.opacity = '1';
                }, 600);

            }, 3000);
        }

        // LOGICA GIOCO PACCHI
        let openedCount = 0;

        function openGift(element) {
            if (element.classList.contains('opened')) return;

            openedCount++;
            element.classList.add('opened');
            const lid = element.querySelector('.gift-lid');
            const content = element.querySelector('.gift-content');

            lid.style.display = 'none';
            content.style.display = 'block';

            if (openedCount < 3) {
                content.innerHTML = "üò¢"; 
            } else {
                content.innerHTML = "üéâ"; 
                launchConfetti();
                setTimeout(() => {
                    document.getElementById('win-message').style.display = 'block';
                    document.getElementById('win-message').animate([
                        { opacity: 0, transform: 'translateY(10px)' },
                        { opacity: 1, transform: 'translateY(0)' }
                    ], { duration: 400, fill: 'forwards' });
                }, 300);
            }
        }

        // Fine Esperienza
        function endGame(type) {
            const currentSlide = document.querySelector('.slide.active');
            currentSlide.classList.remove('active');
            currentSlide.classList.add('exit-up');
            
            setTimeout(() => {
                let finalId = type === 'blocked' ? 'step-blocked' : 'step-end-screen';
                const finalSlide = document.getElementById(finalId);
                finalSlide.classList.add('active');
                if(type !== 'blocked') launchConfetti();
            }, 300);
        }

        // Coriandoli
        function launchConfetti() {
            const colors = ['#ffadad', '#ffd6a5', '#fdffb6', '#caffbf', '#9bf6ff', '#a0c4ff', '#bdb2ff', '#ffc6ff'];
            for (let i = 0; i < 60; i++) {
                const confetti = document.createElement('div');
                confetti.classList.add('confetti');
                const bg = colors[Math.floor(Math.random() * colors.length)];
                const left = Math.random() * 100 + 'vw';
                const animDuration = Math.random() * 3 + 2 + 's'; 
                const size = Math.random() * 6 + 5 + 'px';
                confetti.style.backgroundColor = bg;
                confetti.style.left = left;
                confetti.style.width = size;
                confetti.style.height = size;
                confetti.style.animationDuration = animDuration;
                document.body.appendChild(confetti);
                setTimeout(() => { confetti.remove(); }, 5000);
            }
        }
    </script>
</body>
</html>
